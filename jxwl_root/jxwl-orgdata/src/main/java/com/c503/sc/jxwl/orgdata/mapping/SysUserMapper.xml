<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.c503.sc.jxwl.orgdata.dao.SysUserDao" >
    <resultMap id="BaseResultMap" type="com.c503.sc.jxwl.orgdata.bean.BizUserEntity">
		<!-- 基础属性 -->
		<id column="id" property="id" jdbcType="VARCHAR" />
		<result column="type" property="type" jdbcType="VARCHAR" />
		<result column="name" property="name" jdbcType="VARCHAR" />
		<result column="account" property="account" jdbcType="VARCHAR" />
		<result column="organ_id" property="orgId" jdbcType="VARCHAR" />
		<result column="e_mail" property="eMail" jdbcType="VARCHAR" />
		<result column="mobile" property="mobile" jdbcType="VARCHAR" />
		<result column="qq" property="qq" jdbcType="VARCHAR" />
</resultMap>

    <!-- 注册 保存系统用户信息 -->
    <insert id="saveSysUser" parameterType="java.util.Map" >
   		BEGIN
   		insert into T_SYS_USER
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        ID,
      </if>
      <if test="sysId != null">
      	SYS_ID,
      </if>
      <if test="account != null" >
        ACCOUNT,
      </if>
      <if test="personName != null" >
        NAME,
      </if>
      <if test="type != null" >
        TYPE,
      </if>
      <if test="status != null" >
        STATUS,
      </if>
      <if test="password != null" >
        PASSWORD,
      </if>
      <if test="salt != null">
      	SALT,
      </if>
      <if test="orgId != null" >
        ORGAN_ID,
      </if>
      <if test="identificationCardNo != null" >
        IDCARD,
      </if>
      <if test="personSex != null" >
        SEX,
      </if>
      <if test="telephone != null" >
        MOBILE,
      </if>
      <if test="beginTime != null" >
        BEGIN_TIME,
      </if>
      <if test="endTime != null" >
        END_TIME,
      </if>
      <if test="createBy != null" >
        CREATE_BY,
      </if>
      <if test="createTime != null" >
        CREATE_TIME,
      </if>
      <if test="updateBy != null" >
        UPDATE_BY,
      </if>
      <if test="updateTime != null" >
        UPDATE_TIME,
      </if>
      <if test="remove != null" >
        REMOVE,
      </if>
    </trim>
    <trim prefix="values (" suffix=");" suffixOverrides="," >
      <if test="id != null" >
         #{id,jdbcType=VARCHAR},
      </if>
      <if test="sysId != null">
      	#{sysId,jdbcType=VARCHAR},
      </if>
      <if test="account != null" >
        #{account,jdbcType=VARCHAR},
      </if>
	  <if test="personName != null" >
        #{personName,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        #{type,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
         #{status,jdbcType=VARCHAR},
      </if>
      <if test="password != null" >
        #{password,jdbcType=VARCHAR},
      </if>
      <if test="salt != null" >
        #{salt,jdbcType=VARCHAR},
      </if>
      <if test="orgId != null" >
        #{orgId,jdbcType=VARCHAR},
      </if>
      <if test="identificationCardNo != null" >
        #{identificationCardNo,jdbcType=VARCHAR},
      </if>
      <if test="personSex != null" >
        #{personSex,jdbcType=VARCHAR},
      </if>
      <if test="telephone != null" >
        #{telephone,jdbcType=VARCHAR},
      </if>
      <if test="beginTime != null" >
        #{beginTime,jdbcType=VARCHAR},
      </if>
      <if test="endTime != null" >
        #{endTime,jdbcType=VARCHAR},
      </if>
      <if test="createBy != null" >
        #{createBy,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="updateBy != null" >
        #{updateBy,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null" >
        #{updateTime,jdbcType=VARCHAR},
      </if>
      <if test="remove != null" >
        #{remove,jdbcType=VARCHAR},
      </if>
    </trim>
    
    insert into T_SYS_USER_REL_ROLE
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="userRoleId != null" >
        ID,
      </if>
      <if test="userId != null">
      	USER_ID,
      </if>
      <if test="roleId != null" >
        ROLE_ID,
      </if>
    </trim>
    <trim prefix="values (" suffix=");" suffixOverrides="," >
      <if test="userRoleId != null" >
         #{userRoleId,jdbcType=VARCHAR},
      </if>
      <if test="userId != null">
      	#{userId,jdbcType=VARCHAR},
      </if>
      <if test="roleId != null" >
        #{roleId,jdbcType=VARCHAR},
      </if>
    </trim>
     <!-- 异常处理 -->
	  EXCEPTION
	    WHEN OTHERS THEN
	      ROLLBACK;
	END;  
    </insert>
    

   <!--   更改用户部分信息 -->
    <update id="updateInfo" parameterType="java.util.Map" >
      update  T_SYS_USER
      <set>
      <if test="account != null" >
        ACCOUNT =  #{account,jdbcType=VARCHAR},
      </if>
      <if test="personName != null" >
        NAME =  #{personName,jdbcType=VARCHAR},
      </if>
      <if test="telephone != null" >
        MOBILE = #{telephone,jdbcType=VARCHAR},
      </if>
      <if test="remove != null" >
         REMOVE = #{remove,jdbcType=VARCHAR},
      </if>
    </set>
    WHERE REMOVE = '0'
    <if test="account != null" >
        AND ACCOUNT = #{account,jdbcType=VARCHAR}
    </if>
    </update>
    
</mapper>
